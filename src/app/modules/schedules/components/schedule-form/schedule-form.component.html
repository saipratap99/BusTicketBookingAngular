<form [formGroup]="scheduleDetailsForm" class="mx-auto col-md-6 col-11" (ngSubmit)="onSubmit()">
    <fieldset>
        <div class="mb-3">
            <label for="serviceDetails" class="form-label">Service Details</label>
            <input list="serviceDetails" class="col-sm-6 custom-select custom-select-sm form-control" name="service" formControlName="serviceName" [class.is-invalid]="scheduleDetailsForm.get('serviceName')?.dirty && !isValidServiceDeatils(scheduleDetailsForm.get('serviceName')?.value)" placeholder="Select Service" autocomplete="off">
            <datalist id="serviceDetails" *ngIf="services">
                <option *ngFor="let service of services" [value]="service.serviceName">
            </datalist>
            <div class="invalid-feedback">
                Invalid Service Details. Must select from given details.
            </div>
        </div>

        <div class="mb-3">
            <label for="busDetails" class="form-label">Bus Details</label>
            <input list="busDetails" class="col-sm-6 custom-select custom-select-sm form-control" name="bus" formControlName="busId" [class.is-invalid]="scheduleDetailsForm.get('busId')?.dirty && !isValidBusDetails(scheduleDetailsForm.get('busId')?.value)" placeholder="Select bus" autocomplete="off">
            <datalist id="busDetails" *ngIf="buses">
                <option *ngFor="let bus of buses" [value]="bus.id"> {{ bus.busName }}</option>
            </datalist>
            <div class="invalid-feedback">
                Invalid Bus Details. Must select from given Buses.
            </div>
        </div>
            
        <!--  
        <div class="grid-row">
             <div class="mb-3 grid-col date">
                <label for="departureDate" class="form-label">Departure Date</label>
                <input type="date" class="form-control" id="departureDate" name="departureDate">
            </div>
            <div class="mb-3 grid-col date">
                <label for="arrivalDate" class="form-label">Departure Date</label>
                <input type="date" class="form-control" id="arrivalDate" name="arrivalDate">
            </div>                            
        </div>
        
        -->
        
        <div class="mb-3">
            <label for="week" class="form-label">Week Day</label>
            <input list="weeks" class="col-sm-6 custom-select custom-select-sm form-control" name="week" formControlName="weekDay" [class.is-invalid]="scheduleDetailsForm.get('weekDay')?.dirty && scheduleDetailsForm.get('weekDay')?.invalid" placeholder="Select week" autocomplete="off">
            <datalist id="weeks" *ngIf="weeks">
                <option *ngFor="let week of weeks; let i = index" [value]="i+1">{{ week }}</option>
            </datalist>
            <div class="invalid-feedback">
                Week must be between 1(Sunday) and 7(Saturday)
            </div>
        </div>
       
        <div class="grid-row">
            <div class="mb-3 grid-col">
                <label for="departureTime" class="form-label">Departure Time</label>
                <input type="time" class="form-control" id="departureTime" name="depTime" formControlName="departureTime">
            </div>    
        
            <div class="mb-3 grid-col">
                <label for="tripDuration" class="form-label">Duration</label>
                <input type="time" class="form-control" id="tripDuration" name="tripDuration" formControlName="duration">
            </div>          
        </div>
        
        <div class="mb-3">
            <label for="basePrice" class="form-label">Base price</label>
            <input type="number" class="form-control" id="basePrice" name="basePrice" formControlName="basePrice" [class.is-invalid]="scheduleDetailsForm.get('basePrice')?.dirty && scheduleDetailsForm.get('basePrice')?.invalid">
            <div class="invalid-feedback">
                Base price must be atleast {{  30 | currency: 'INR' }}.
            </div>
        </div>
        
        <div *ngIf="!disabled">
            <button type="submit" class="btn btn-primary" [disabled]="!scheduleDetailsForm.valid" [disabled]="loading">
                <span *ngIf="loading">
                    <span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span>
                </span>
                {{ loading ? 'Loading..' : 'Submit'}}
            </button>
        </div>
        
    </fieldset>
</form>

